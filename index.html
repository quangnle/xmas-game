<!DOCTYPE html>
    <html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Treasure Hunt</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-slate-800 text-white h-screen flex flex-col overflow-hidden select-none font-sans">

    <!-- Header Info -->
    <div class="bg-slate-900 p-2 shadow-lg z-10 flex justify-between items-center border-b border-slate-700">
        <div class="flex items-center gap-2">
            <div id="currentPlayerAvatar" class="w-8 h-8 rounded-full border-2 border-white shadow-sm flex items-center justify-center text-xs font-bold bg-red-500">P1</div>
            <div>
                <h1 class="text-sm font-bold text-yellow-400 uppercase tracking-wider">Treasure</h1>
                <p class="text-xs text-gray-300">Turn: <span id="turnIndicator" class="font-bold text-white">Player 1</span></p>
                <p class="text-xs text-gray-400">Room: <span id="lobbyCodeHeader" class="font-mono font-bold text-blue-400">------</span></p>
            </div>
        </div>
        <div class="flex items-center gap-4">
            <div class="text-center">
                <span class="block text-xs text-gray-400">Coins</span>
                <span id="coinDisplay" class="text-yellow-400 font-bold"><i class="fas fa-coins"></i> 0</span>
            </div>
            <button id="inventoryBtn" class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg relative">
                <i class="fas fa-suitcase text-yellow-100"></i>
                <span id="inventoryCount" class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-4 h-4 rounded-full flex items-center justify-center hidden">0</span>
            </button>
        </div>
    </div>

    <!-- Game Area (Canvas) -->
    <div class="flex-1 relative overflow-hidden bg-gray-900 flex items-center justify-center" id="gameContainer">
        <canvas id="gameCanvas" class="absolute top-0 left-0"></canvas>
        
        <!-- Floating Info: Dice & Moves -->
        <div class="absolute top-4 left-1/2 transform -translate-x-1/2 bg-black/70 backdrop-blur-md px-4 py-2 rounded-full flex items-center gap-4 shadow-xl border border-white/10">
            <div class="flex flex-col items-center">
                <span class="text-[10px] text-gray-300 uppercase">Dice</span>
                <span id="diceValue" class="text-xl font-bold text-cyan-400">-</span>
            </div>
            <div class="h-8 w-px bg-gray-500"></div>
            <div class="flex flex-col items-center">
                <span class="text-[10px] text-gray-300 uppercase">Moves</span>
                <span id="movesLeft" class="text-xl font-bold text-green-400">0</span>
            </div>
        </div>

        <!-- Action Overlay -->
        <div id="actionOverlay" class="absolute inset-0 bg-black/40 hidden flex items-center justify-center z-20 pointer-events-none">
            <div class="bg-white text-slate-900 p-4 rounded-lg shadow-2xl animate-bounce">
                <p id="actionMessage" class="font-bold">Your turn!</p>
            </div>
        </div>
    </div>

    <!-- Controls -->
    <div class="bg-slate-900 p-3 pb-6 shadow-[0_-4px_10px_rgba(0,0,0,0.3)] z-10 border-t border-slate-700">
        <div class="flex justify-between items-center max-w-md mx-auto gap-4">
            
            <!-- D-Pad -->
            <div class="grid grid-cols-3 gap-1 w-28 h-28 shrink-0">
                <div></div>
                <button id="btnUp" class="bg-slate-700 active:bg-slate-600 rounded flex items-center justify-center shadow-md border-b-4 border-slate-800 active:border-b-0 active:translate-y-1"><i class="fas fa-chevron-up"></i></button>
                <div></div>
                <button id="btnLeft" class="bg-slate-700 active:bg-slate-600 rounded flex items-center justify-center shadow-md border-b-4 border-slate-800 active:border-b-0 active:translate-y-1"><i class="fas fa-chevron-left"></i></button>
                <div class="bg-slate-800 rounded flex items-center justify-center"><i class="fas fa-arrows-alt text-slate-600"></i></div>
                <button id="btnRight" class="bg-slate-700 active:bg-slate-600 rounded flex items-center justify-center shadow-md border-b-4 border-slate-800 active:border-b-0 active:translate-y-1"><i class="fas fa-chevron-right"></i></button>
                <div></div>
                <button id="btnDown" class="bg-slate-700 active:bg-slate-600 rounded flex items-center justify-center shadow-md border-b-4 border-slate-800 active:border-b-0 active:translate-y-1"><i class="fas fa-chevron-down"></i></button>
                <div></div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-col gap-2 flex-1">
                <button id="rollBtn" class="bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold py-3 px-4 rounded-lg shadow-lg border-b-4 border-yellow-700 active:border-b-0 active:translate-y-1 transition-all w-full flex justify-center items-center gap-2">
                    <i class="fas fa-dice"></i> ROLL DICE
                </button>
                <div class="flex gap-2">
                    <button id="digBtn" disabled class="flex-1 bg-amber-700 hover:bg-amber-600 text-white font-bold py-2 rounded-lg shadow border-b-4 border-amber-900 transition-all flex justify-center items-center gap-1 disabled:opacity-50">
                        <i class="fas fa-hammer"></i> DIG
                    </button>
                    <button id="skipBtn" disabled class="flex-1 bg-red-500 hover:bg-red-400 text-white font-bold py-2 rounded-lg shadow border-b-4 border-red-700 active:border-b-0 active:translate-y-1 transition-all flex justify-center items-center gap-1 disabled:opacity-50 disabled:bg-gray-600">
                        <i class="fas fa-forward"></i> NEXT TURN
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Generic Modal -->
    <div id="modal" class="fixed inset-0 bg-black/80 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white text-slate-900 rounded-xl shadow-2xl max-w-sm w-full overflow-hidden transform transition-all scale-100">
            <div class="bg-slate-100 p-4 border-b flex justify-between items-center">
                <h3 id="modalTitle" class="font-bold text-lg">Notification</h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-red-500"><i class="fas fa-times"></i></button>
            </div>
            <div id="modalContent" class="p-6 text-center">
                <!-- Content injected here -->
            </div>
            <div class="p-4 bg-slate-50 flex justify-center">
                <button onclick="closeModal()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-500 font-bold">Close</button>
            </div>
        </div>
    </div>

    <!-- Inventory Modal -->
    <div id="inventoryModal" class="fixed inset-0 bg-black/90 hidden z-50 flex flex-col p-4">
        <div class="flex justify-between items-center mb-4 text-white">
            <h2 class="text-2xl font-bold"><i class="fas fa-suitcase"></i> Inventory & Clues</h2>
            <button id="closeInventoryBtn" class="bg-red-500 w-10 h-10 rounded-full text-white font-bold"><i class="fas fa-times"></i></button>
        </div>
        <div id="inventoryList" class="flex-1 overflow-y-auto grid grid-cols-1 gap-6 p-4">
            <!-- Items injected here -->
        </div>
    </div>

    <!-- Duel Modal -->
    <div id="duelModal" class="fixed inset-0 bg-red-900/90 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-900 border-4 border-red-500 text-white rounded-xl shadow-2xl max-w-sm w-full p-6 text-center">
            <h2 class="text-3xl font-bold text-red-500 mb-2">⚔ DUEL ⚔</h2>
            <p class="text-gray-300 mb-6">Higher dice roll wins!</p>
            
            <div class="flex justify-around items-center mb-8">
                <div class="text-center">
                    <div id="duelP1Avatar" class="w-16 h-16 rounded-full border-4 border-white mb-2 mx-auto flex items-center justify-center text-xl bg-blue-500">P1</div>
                    <div id="duelResult1" class="text-4xl font-bold text-yellow-400">-</div>
                </div>
                <div class="text-2xl font-bold text-red-500">VS</div>
                <div class="text-center">
                    <div id="duelP2Avatar" class="w-16 h-16 rounded-full border-4 border-white mb-2 mx-auto flex items-center justify-center text-xl bg-green-500">P2</div>
                    <div id="duelResult2" class="text-4xl font-bold text-yellow-400">-</div>
                </div>
            </div>

            <button id="duelRollBtn" class="bg-red-600 hover:bg-red-500 w-full py-3 rounded-lg font-bold text-xl uppercase shadow-lg animate-pulse">
                Fight!
            </button>
        </div>
    </div>

    <script type="module" src="client/main.js"></script>
</body>
</html>